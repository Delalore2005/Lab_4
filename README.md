# LAB_4 — Кластеризация данных Airbnb

## Обзор
Отчёт составлен «в духе отличника»: кратко, по делу и с иллюстрациями. Ниже собраны шаги обработки объявлений Airbnb по Нью-Йорку за 2019 год — от выявления проблемных данных в R до сравнения четырёх кластеризаций в Python (включая собственный K-Means). Все ключевые графики вынесены прямо в README для наглядности, а результаты сведены в таблицу.

## Состав репозитория
- `r_scripts/cleaning_airbnb.ipynb` — поиск пропусков, дубликатов и выбросов, первичный анализ и визуализация очищенных данных в R.
- `py_scripts/airbnb_clustering.py.ipynb` — масштабирование признаков, кластеризация (включая собственный K-Means) и визуализация в Python.
- `images/` — экспортированные графики (распределения, масштабирование, кластеры и др.), используемые в отчёте ниже.
- `docker-compose.yml` — окружение c Jupyter Notebook и RStudio.
- `docker_container.zip` — архив с контейнером и исходной структурой проекта.

> Очищенный датасет (`data/airbnb_clean.csv`) упоминается в ноутбуках, но не включён в репозиторий.

## 1. Проблемные данные (R)
- Пропуски обнаружены в `last_review` и `reviews_per_month`; показаны через матрицу пропусков и сводные таблицы частот.
- Найдено и удалено 252 дубликата; фильтры отсекли строки с невалидной ценой (≤0) и экстремами (>500) по IQR.
- Пропуски `reviews_per_month` заменены на 0, что сохранило информативность признака для малоактивных объявлений.

**Выводы по исходному датасету.** 48 895 строк с правосторонней асимметрией цен и редкими, но значимыми выбросами по `minimum_nights` и `number_of_reviews`. После очистки осталось 47 640 записей; неинформативные поля (`id`, `name`, `host_name`, `last_review`) исключены.

### Визуализации проблем и очищенных данных
![Распределение цен после фильтрации аномалий](images/price_distribution.png)

![Boxplot числовых признаков после очистки](images/numeric_features_boxplot.png)

## 2. Масштабирование и нормализация (Python)
- Для подготовки к кластеризации применён `StandardScaler` — приведение признаков к нулевому среднему и единичному стандартному отклонению.
- Масштабирование устраняет доминирование признаков с крупными значениями в метрике расстояния и стабилизирует обучение.

![Цена до и после масштабирования](images/price_scaling_comparison.png)

## 3. Кластеризация
Алгоритмы обучены на масштабированных признаках; для отображения использована PCA до 2 компонент.

### Визуализации кластеров
| Алгоритм | Визуализация |
| --- | --- |
| Собственный **K-Means** | ![K-Means custom](images/kmeans_custom.png) |
| **K-Means (scikit-learn)** | ![K-Means sklearn](images/kmeans_sklearn.png) |
| **Agglomerative Clustering** | ![Agglomerative](images/agglomerative_clustering.png) |
| **Gaussian Mixture Model (GMM)** | ![GMM](images/gaussian_mixture.png) |

### Силуэты и краткие выводы
| Алгоритм | Silhouette score | Комментарий |
| --- | --- | --- |
| K-Means (custom) | 0.3513 | Базовая интерпретируемая модель; стабильно формирует кластеры по уровню цены/активности. |
| K-Means (sklearn) | 0.3513 | Совпадает с кастомной реализацией, подтверждая корректность реализации. |
| Gaussian Mixture Model | 0.3795 | Лучший силуэт; гибче разделяет перекрывающиеся кластеры. |
| Agglomerative Clustering | 0.3018 | Худший результат; чувствителен к форме кластеров и масштабам признаков. |

**Итог:** GMM даёт максимум силуэта, однако K-Means остаётся прозрачной и быстрой базой. Кластеры интерпретируются как сочетания доступности и ценового уровня: от доступных предложений с высокой активностью до премиальных объявлений с низкой доступностью и большим числом отзывов.

## 4. ZIP-архив контейнера
`docker_container.zip` включает `docker-compose.yml`, каталоги `r_scripts/` и `py_scripts/`, а также сопутствующие файлы для локального развертывания окружения. Для запуска:

```bash
docker-compose up -d
```

Доступные сервисы: Jupyter Notebook (порт 8888, токен в логах) и RStudio (порт 8787, пароль `password`).

## 5. Локальный запуск без архива
1. Установите Docker и Docker Compose.
2. Запустите сервисы: `docker-compose up -d`.
3. Откройте в браузере интерфейс RStudio (порт 8787) или Jupyter (порт 8888) и работайте с ноутбуками из `r_scripts/` и `py_scripts/`.
